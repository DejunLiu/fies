/*
 * imx28_gic.h
 *
 *  Created on: 25.06.2014
 *      Author: Schoenfelder
 */

#ifndef IMX28_GIC_H_
#define IMX28_GIC_H_

#include "hw/sysbus.h"
#include "hw/intc/arm_gic.h"

#define TYPE_IMX28_GIC "imx28_gic"
#define IMX28_GIC(obj) \
    OBJECT_CHECK(IMX28GICState, (obj), TYPE_IMX28_GIC)

#define IMX28_GIC_NUM_IRQS	128
#define NUM_HW_ICOLL_REGS 146

#define HW_ICOLL_VECTOR 				0
#define HW_ICOLL_LEVELACK 			1
#define HW_ICOLL_CTRL					2
#define HW_ICOLL_VBASE					3
#define HW_ICOLL_STAT					4
#define HW_ICOLL_RAW0					5
#define HW_ICOLL_RAW1					6
#define HW_ICOLL_RAW2					7
#define HW_ICOLL_RAW3					8
#define HW_ICOLL_INTERRUPT0		9
#define HW_ICOLL_INTERRUPT1		10
#define HW_ICOLL_INTERRUPT2		11
#define HW_ICOLL_INTERRUPT3		12
#define HW_ICOLL_INTERRUPT4		13
#define HW_ICOLL_INTERRUPT5		14
#define HW_ICOLL_INTERRUPT6		15
#define HW_ICOLL_INTERRUPT7		16
#define HW_ICOLL_INTERRUPT8		17
#define HW_ICOLL_INTERRUPT9		18
#define HW_ICOLL_INTERRUPT10		19
#define HW_ICOLL_INTERRUPT11		20
#define HW_ICOLL_INTERRUPT12		21
#define HW_ICOLL_INTERRUPT13		22
#define HW_ICOLL_INTERRUPT14		23
#define HW_ICOLL_INTERRUPT15		24
#define HW_ICOLL_INTERRUPT16		25
#define HW_ICOLL_INTERRUPT17		26
#define HW_ICOLL_INTERRUPT18		27
#define HW_ICOLL_INTERRUPT19		28
#define HW_ICOLL_INTERRUPT20		29
#define HW_ICOLL_INTERRUPT21		30
#define HW_ICOLL_INTERRUPT22		31
#define HW_ICOLL_INTERRUPT23		32
#define HW_ICOLL_INTERRUPT24		33
#define HW_ICOLL_INTERRUPT25		34
#define HW_ICOLL_INTERRUPT26		35
#define HW_ICOLL_INTERRUPT27		36
#define HW_ICOLL_INTERRUPT28		37
#define HW_ICOLL_INTERRUPT29		38
#define HW_ICOLL_INTERRUPT30		39
#define HW_ICOLL_INTERRUPT31		40
#define HW_ICOLL_INTERRUPT32		41
#define HW_ICOLL_INTERRUPT33		42
#define HW_ICOLL_INTERRUPT34		43
#define HW_ICOLL_INTERRUPT35		44
#define HW_ICOLL_INTERRUPT36		45
#define HW_ICOLL_INTERRUPT37		46
#define HW_ICOLL_INTERRUPT38		47
#define HW_ICOLL_INTERRUPT39		48
#define HW_ICOLL_INTERRUPT40		49
#define HW_ICOLL_INTERRUPT41		50
#define HW_ICOLL_INTERRUPT42		51
#define HW_ICOLL_INTERRUPT43		52
#define HW_ICOLL_INTERRUPT44		53
#define HW_ICOLL_INTERRUPT45		54
#define HW_ICOLL_INTERRUPT46		55
#define HW_ICOLL_INTERRUPT47		56
#define HW_ICOLL_INTERRUPT48		57
#define HW_ICOLL_INTERRUPT49		58
#define HW_ICOLL_INTERRUPT50		59
#define HW_ICOLL_INTERRUPT51		60
#define HW_ICOLL_INTERRUPT52		61
#define HW_ICOLL_INTERRUPT53		62
#define HW_ICOLL_INTERRUPT54		63
#define HW_ICOLL_INTERRUPT55		64
#define HW_ICOLL_INTERRUPT56		65
#define HW_ICOLL_INTERRUPT57		66
#define HW_ICOLL_INTERRUPT58		67
#define HW_ICOLL_INTERRUPT59		68
#define HW_ICOLL_INTERRUPT60		69
#define HW_ICOLL_INTERRUPT61		70
#define HW_ICOLL_INTERRUPT62		71
#define HW_ICOLL_INTERRUPT63		72
#define HW_ICOLL_INTERRUPT64		73
#define HW_ICOLL_INTERRUPT65		74
#define HW_ICOLL_INTERRUPT66		75
#define HW_ICOLL_INTERRUPT67		76
#define HW_ICOLL_INTERRUPT68		77
#define HW_ICOLL_INTERRUPT69		78
#define HW_ICOLL_INTERRUPT70		79
#define HW_ICOLL_INTERRUPT71		80
#define HW_ICOLL_INTERRUPT72		81
#define HW_ICOLL_INTERRUPT73		82
#define HW_ICOLL_INTERRUPT74		83
#define HW_ICOLL_INTERRUPT75		84
#define HW_ICOLL_INTERRUPT76		85
#define HW_ICOLL_INTERRUPT77		86
#define HW_ICOLL_INTERRUPT78		87
#define HW_ICOLL_INTERRUPT79		88
#define HW_ICOLL_INTERRUPT80		89
#define HW_ICOLL_INTERRUPT81		90
#define HW_ICOLL_INTERRUPT82		91
#define HW_ICOLL_INTERRUPT83		92
#define HW_ICOLL_INTERRUPT84		93
#define HW_ICOLL_INTERRUPT85		94
#define HW_ICOLL_INTERRUPT86		95
#define HW_ICOLL_INTERRUPT87		96
#define HW_ICOLL_INTERRUPT88		97
#define HW_ICOLL_INTERRUPT89		98
#define HW_ICOLL_INTERRUPT90		99
#define HW_ICOLL_INTERRUPT91		100
#define HW_ICOLL_INTERRUPT92		101
#define HW_ICOLL_INTERRUPT93		102
#define HW_ICOLL_INTERRUPT94		103
#define HW_ICOLL_INTERRUPT95		104
#define HW_ICOLL_INTERRUPT96		105
#define HW_ICOLL_INTERRUPT97		106
#define HW_ICOLL_INTERRUPT98		107
#define HW_ICOLL_INTERRUPT99		108
#define HW_ICOLL_INTERRUPT100	109
#define HW_ICOLL_INTERRUPT101	110
#define HW_ICOLL_INTERRUPT102	111
#define HW_ICOLL_INTERRUPT103	112
#define HW_ICOLL_INTERRUPT104	113
#define HW_ICOLL_INTERRUPT105	114
#define HW_ICOLL_INTERRUPT106	115
#define HW_ICOLL_INTERRUPT107	116
#define HW_ICOLL_INTERRUPT108	117
#define HW_ICOLL_INTERRUPT109	118
#define HW_ICOLL_INTERRUPT110	119
#define HW_ICOLL_INTERRUPT111	120
#define HW_ICOLL_INTERRUPT112	121
#define HW_ICOLL_INTERRUPT113	122
#define HW_ICOLL_INTERRUPT114	123
#define HW_ICOLL_INTERRUPT115	124
#define HW_ICOLL_INTERRUPT116	125
#define HW_ICOLL_INTERRUPT117	126
#define HW_ICOLL_INTERRUPT118	127
#define HW_ICOLL_INTERRUPT119	128
#define HW_ICOLL_INTERRUPT120	129
#define HW_ICOLL_INTERRUPT121	130
#define HW_ICOLL_INTERRUPT122	131
#define HW_ICOLL_INTERRUPT123	132
#define HW_ICOLL_INTERRUPT124	133
#define HW_ICOLL_INTERRUPT125	134
#define HW_ICOLL_INTERRUPT126	135
#define HW_ICOLL_INTERRUPT127	136
#define HW_ICOLL_DEBUG				137
#define HW_ICOLL_DBGREAD0			138
#define HW_ICOLL_DBGREAD1			139
#define HW_ICOLL_DBGFLAG			140
#define HW_ICOLL_DBGREQUEST0	141
#define HW_ICOLL_DBGREQUEST1	142
#define HW_ICOLL_DBGREQUEST2	143
#define HW_ICOLL_DBGREQUEST3	144
#define HW_ICOLL_VERSION				145

#define SFTRST	(1<<31)

#define PRIO_PER_WORD (sizeof(uint32_t) * 8 / 4)
#define PRIO_WORDS (IMX28_GIC_NUM_IRQS/PRIO_PER_WORD)

typedef struct IMX28GICState {
    SysBusDevice parent_obj;

    MemoryRegion iomem;

    qemu_irq irq;
    qemu_irq fiq;

    uint64_t pending_low;
    uint64_t pending_high;

    uint32_t hw_icoll_regs[NUM_HW_ICOLL_REGS];
} IMX28GICState;


#endif /* IMX28_GIC_H_ */
